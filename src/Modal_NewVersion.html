<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <style>
      .highlights {
        width: 95%;
        height: 165px;
        overflow: auto;
        border: 1px solid gray;
        padding: 4px;
      }
      
      .title {
        font-weight: bold;
      }
      
      button {
        cursor: pointer;
      }
      
      button.close {
      }
    </style>
  </head>
  <body>
    <div>
      <p>ESD has updated to version: <span id="versionNumber" style="color:green"></span></p>
    </div>
    <div class="highlights">
      <!--Release Highlights-->
      <div class="title"><u>General</u></div>
      <ul>
        <li>Added support for specifying date-time value formatting.</li>
        <li>Misc CSS and UX adjustments.</li>
      </ul>
      <div class="title"><u>JSON</u></div>
      <ul>
        <li>Date strings in cell arrays are now parsed into actual date values, unless escaped with double quotes.</li>
        <li>Escaped strings in cell arrays are now preserved as strings more aggressively.</li>
        <ul>
          <li><b>Example Input</b></li>
          <ul>
            <li>2,"2",6-7,"6-7"</li>
          </ul>
          <li><b>Current</b></li>
          <ul>
            <li>[ 2, "2", "2001-06-07T04:00:00.000Z", "6-7" ]</li>
          </ul>
          <li><b>Previous</b></li>
          <ul>
            <li>[ 2, 2, "6-7", "\"6-7\"" ]</li>
          </ul>
        </ul>
      </ul>
      <div class="title"><u>Backend Updates</u></div>
      (Preserved these notes from v66 since they are significant changes)
      <ul>
        <li>Migrated DriveApp calls to the Drive API to support more limited security scopes.</li>
        <ul>
          <li><u>You will need to reassign custom export location values due to this change!</u></li>
        </ul>
        <li>Exporting now places files in your root "My Drive" folder by default, instead of the same folder as the original spreadsheet. This is a limitation of the more limited scopes :(</li>
      </ul>
    </div>
    <div>
      <p>For more information, see <a href="https://github.com/Synthoid/ExportSheetData/blob/master/ReleaseNotes.pdf" target="blank">ESD's release notes</a></p>
    </div>
    <button class="close" onclick="google.script.host.close()">Close</button>
    <script type="application/javascript">
      function refreshVersion()
      {
        google.script.run.withSuccessHandler(onVersionSuccess).getVersion()
      }
      
      function onVersionSuccess(version)
      {
        document.getElementById("versionNumber").innerHTML = "v" + version;
      }
      
      refreshVersion();
    </script>
  </body>
</html>